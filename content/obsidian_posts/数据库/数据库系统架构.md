数据库的三层架构设计：
![[数据库/image-5 1.png]]
最上层：用户逻辑层——单个用户或应用程序看待数据的视图
中间层：社区逻辑层（概念层）——整个数据库的全局逻辑结构
最底层：物理层——数据在存储介质上的实际存储方式，由DDL书写定义

# 数据子语言（DSL）：
## 什么是DSL：
- 嵌入宿主语言中，专门用于操作数据库的语言组件
- 只负责数据库操作（增删改查，定义结构）
## DSL与宿主语言的关系：
- 分工协作：DSL只管数据
- 嵌入方式：紧密耦合（预编译）松散耦合（调用接口）

# 三级层次结构是如何在关系型系统中实现的：
- 概念层必然是关系型的
- 一个给定的外部层视图必将是关系型的
- 内部层必然不是关系型的：存储记录，指针，索引，哈希

# 映射
## 概念层与内部层之间的映射
- 定义了概念视图与存储的数据库之间的对应关系
- 指明概念记录与字段在内部层是如何表示的
- 物理数据独立性的关键：如果存储方式变了，两者的映射也要随之改变，以便概念模式保持不变
## 外部层与概念层之间的映射
- 任意数量的用户可以共享一个外部视图
- 不同的外部视图可以重叠
- 字段有不同的数据类型；字段的名称可以更改
- 是实现逻辑数据独立性的关键
##  映射和数据的独立性
- 数据独立性：修改一个级别的定义不影响更高一级的定义能力
- 逻辑数据独立性：改变该概念模型而不必改变外部模式或应用程序的能力
- 物理数据独立性：改变内部存储方式而不必改变概念模式

视图时根据业务逻辑设计的，从一个或多个关系变量或基本表中导出的虚拟表。

# DB2是如何解决SQL的change请求的
- 解析与检查：检查语法与权限
- 查询优化：基于数据字典和成本模型，生成并执行最优计划
- 查询执行：执行计划，并调用查询引擎
- 返回结果
例如用户想要改变薪水：
![[数据库/image-5 1.png]]
完成改变之后：
![[数据库/image-5 2.png]]

# DBMS函数（职能）
- 数据定义与数据字典：提供DDL，采用三级模式。
**数据字典：**
数据字典就是系统目录，存储所有元数据（模式，视图，权限等），是DBMS运行的基础
例如：
```
SELECT TABLE_NAME FROM USER_TABLE;
```
- 数据组织与高效存取
- 数据操纵与优化
- 事务管理与并发控制
    - 事务的ACID特性：
        - A原子性：事务为执行的最小单位
        - C一致性：事务使数据库从一个一致状态变为另一个一致状态
        - I隔离性：并发的事务互不干扰
        - 持久性：事务提交后，其结果永久有效
    - 什么是死锁：
        两个以上的事务互相等待对方释放锁，无法继续进程
- 数据库保护

# DBMS与文件管理系统的关系
- FMS是底层操作系统中管理存储文件的组件，更加接近磁盘
- DBMS建立在某种FMS上
- FMS用户可以创建和销毁存储文件

**FMS的局限性：**
- 不了解记录的内部结构
- 难以支持安全性与完整性约束
- 难以支持恢复和并发控制
- 文件难以集成和共享
